import UIKit

class AppNavigator {
    
    // Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ÙˆØ­Ø¯Ø© (Singleton) Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    static let shared = AppNavigator()
    
    private init() {}
    
    // MARK: - Main Navigation Function
    /// Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© ØªÙ‚Ø±Ø± Ø£ÙŠÙ† ÙŠØ°Ù‡Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¯ÙˆØ±Ù‡
    func navigateToRoleBasedHome(role: String) {
        print("ğŸ§­ Navigating based on role: \(role)")
        
        switch role {
        case "Seeker":
            navigateToSeekerProfile()
        case "Provider":
            navigateToProviderProfile()
        case "Admin":
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù„Ù„Ø£Ø¯Ù…Ù†
             navigateToHome()
        default:
            navigateToHome()
        }
    }
    
    // MARK: - Private Navigations
    
    // 1. Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ø¨Ø§Ø­Ø«
    private func navigateToSeekerProfile() {
        let storyboard = UIStoryboard(name: "SeekerProfile", bundle: nil)
        // ØªØ£ÙƒØ¯ Ø£Ù† Storyboard ID Ù‡Ùˆ "SeekerProfileViewController"
        if let vc = storyboard.instantiateViewController(withIdentifier: "SeekerProfileViewController") as? SeekerProfileViewController {
            setRoot(viewController: vc)
        } else {
            print("ğŸ”´ Error: SeekerProfileViewController ID not found.")
        }
    }
    
    // 2. Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ù…Ø²ÙˆØ¯
    private func navigateToProviderProfile() {
        let storyboard = UIStoryboard(name: "ProviderProfile", bundle: nil)
        // ØªØ£ÙƒØ¯ Ø£Ù† Storyboard ID Ù‡Ùˆ "ProviderMainProfileVC"
        if let vc = storyboard.instantiateViewController(withIdentifier: "ProviderMainProfileVC") as? ProviderMainProfileVC {
            setRoot(viewController: vc)
        } else {
            print("ğŸ”´ Error: ProviderMainProfileVC ID not found.")
        }
    }
    
    // 3. Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© (Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ)
    private func navigateToHome() {
        let storyboard = UIStoryboard(name: "Home", bundle: nil)
        // ØªØ£ÙƒØ¯ Ø£Ù† Storyboard ID Ù‡Ùˆ "HomeFeedViewController"
        if let vc = storyboard.instantiateViewController(withIdentifier: "HomeFeedViewController") as? HomeFeedViewController {
            setRoot(viewController: vc)
        } else {
            print("ğŸ”´ Error: HomeFeedViewController ID not found.")
        }
    }
    
    // MARK: - Helper Function to Change Root
    // Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© ØªÙ‚ÙˆÙ… Ø¨Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ø¨Ø¯ÙˆÙ† Ø²Ø± Ø±Ø¬ÙˆØ¹)
    private func setRoot(viewController: UIViewController) {
        guard let windowScene = UIApplication.shared.connectedScenes.first as? UIWindowScene,
              let window = windowScene.windows.first else {
            return
        }
        
        window.rootViewController = viewController
        window.makeKeyAndVisible()
        
        // ØªØ£Ø«ÙŠØ± Ø­Ø±ÙƒÙŠ Ø¬Ù…ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
        UIView.transition(with: window, duration: 0.5, options: .transitionFlipFromRight, animations: nil, completion: nil)
    }
}
